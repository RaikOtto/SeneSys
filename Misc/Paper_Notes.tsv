= Generation of Signature =

Data basis: TIS dataset
* Suv39h1 WT
* Suv39h1KO
* SuvER (4OHT-inducible Suv39h1-)
* native and ADR-treated

Two groups
2) senescent: ADR-treated Suv39h1WT or ADR/4OHT-treated SuvER
1) non-senescent: everything else, i.e. native and ADR-treated Suv39h1- or SuvER lymphoma

First Step: Differential Gene Expression comparing the two groups
* Remove features without known annotation
* collapse features to gene-level by "maxSignificance": use probeset with highest statistical significance between two sample groups
* Do DiffGene Analysis with limma package: limma::lmFit, limma::eBayes
- Adjust p-values using "BH"
- Select genes with BH-adjusted p-value < 0.01 and logFC > 1
--> genesetTIS.txt (tab-separated, Symbol = mouse; HugoSymbol = human homologues)

Manuscript Figure 5A

Second Step: GSEA Analysis
* datasets: in vitro mouse, clinical trial-like in vivo mouse and human datasets GSE31312, GSE98588
* Use large collection of gene sets from various sources, e.g. MSigDB, including the TIS up/down signature
* Figure 6A shows the enrichment profiles for "TIS up" genes
* FDR is computed using gene permuation and qvalue
* Select genes from enrichment plot leading edges of each of the four
* Combine genes using intersect() --> Gene list in Table S1 --> genesetTIS.txt (CoreEnrichment = yes)


Third Step: Application using SUVARness genes in Table S1
* Select target genes
* center using row-mean and scale to unit-variance
* collapse multiple features to gene-level using a correlation approach suggested by Monti, S., Savage, K.J., Kutok, J.L., Feuerhake, F., Kurtin, P., Mihm, M., Wu, B., Pasqualucci, L., Neuberg, D., Aguiar, R.C., et al. (2005). Molecular profiling of diffuse large B-cell lymphoma identifies robust subtypes including one characterized by host inflammatory response. Blood 105, 1851-1861.
-- compute correlation of multiple features: correlation matrix using stats::cor and remove self correlation (diagonal set to NA). Compute average correlation c
-> if c > 0.2 collapse by "mean" otherwise by "maxMean", i.e. use probeset with highest average expression across samples
* compute sample-wise average of genes to compute a meta signature
* finally split samples into two groups based on median expression of this meta signature
* Analyse for survival differences between above/below median: Figure 6B for in vivo mouse C/D for human GSE31312 and Figure S6 for human GSE4475 (A) and GSE10846 (B).
